##numSNP
numSNP <- "
Alzheimer's_Disease NaN 144.0 314.0 35.0 59.0 39.0 72.0 164.0 306.0 88.0 207.0 31.0 NaN 470.0 2.0 14.0 5.0 9.0 476.0 6.0 45.0 NaN 1.0 3.0 19.0 NaN 7.0 NaN
Diabetes_mellitus_type_1  69.0 NaN 279.0 29.0 56.0 39.0 71.0 143.0 292.0 87.0 200.0 29.0 NaN 447.0 2.0 14.0 4.0 9.0 420.0 6.0 34.0 NaN 1.0 1.0 16.0 NaN 4.0 NaN
Diabetes_mellitus_type_2 86.0 145.0 NaN 35.0 60.0 40.0 74.0 168.0 306.0 86.0 209.0 32.0 NaN 478.0 2.0 14.0 5.0 9.0 477.0 6.0 44.0 NaN 1.0 3.0 19.0 NaN 8.0 NaN
Covid-19_infection 85.0 145.0 309.0 NaN 60.0 40.0 74.0 165.0 306.0 88.0 209.0 31.0 NaN 480.0 2.0 14.0 5.0 9.0 477.0 6.0 43.0 NaN 1.0 2.0 19.0 NaN 7.0 NaN
Covid-19_Very_severe_respiratory_confirmed_covid_vs._population 83.0 143.0 304.0 35.0 NaN 40.0 72.0 164.0 306.0 88.0 209.0 31.0 NaN 474.0 2.0 14.0 5.0 9.0 476.0 6.0 42.0 NaN 1.0 1.0 19.0 NaN 7.0 NaN
Sleep_apnea 69.0 139.0 284.0 32.0 56.0 NaN 69.0 145.0 293.0 83.0 196.0 31.0 NaN 444.0 2.0 14.0 5.0 6.0 438.0 6.0 36.0 NaN 1.0 NaN 15.0 NaN 7.0 NaN
Cigarrete_day 87.0 143.0 309.0 36.0 60.0 40.0 NaN 168.0 305.0 84.0 209.0 31.0 NaN 475.0 2.0 14.0 5.0 9.0 475.0 6.0 42.0 NaN 1.0 1.0 19.0 NaN 7.0 NaN
Drink_Weekly 87.0 143.0 308.0 36.0 59.0 40.0 75.0 NaN 305.0 84.0 209.0 30.0 NaN 470.0 2.0 14.0 5.0 9.0 475.0 6.0 42.0 NaN 1.0 1.0 19.0 NaN 7.0 NaN
Coronary_artery_disease 87.0 145.0 318.0 35.0 60.0 40.0 75.0 169.0 NaN 88.0 209.0 32.0 NaN 482.0 2.0 14.0 5.0 9.0 477.0 6.0 44.0 NaN 1.0 3.0 19.0 NaN 7.0 NaN
Depressive_disorder 77.0 143.0 293.0 35.0 56.0 40.0 72.0 152.0 302.0 NaN 203.0 32.0 NaN 462.0 2.0 14.0 5.0 9.0 468.0 6.0 43.0 NaN 1.0 2.0 17.0 NaN 7.0 NaN
Diet 84.0 147.0 304.0 35.0 60.0 40.0 74.0 168.0 306.0 88.0 NaN 31.0 NaN 482.0 2.0 14.0 5.0 9.0 477.0 6.0 42.0 NaN 1.0 1.0 19.0 NaN 7.0 NaN
Heart_failure 81.0 142.0 337.0 34.0 59.0 40.0 75.0 167.0 304.0 88.0 206.0 NaN NaN 478.0 2.0 14.0 5.0 9.0 461.0 6.0 43.0 NaN 1.0 5.0 19.0 NaN 7.0 NaN
HIV_infection 86.0 144.0 321.0 35.0 59.0 40.0 74.0 160.0 304.0 88.0 207.0 34.0 NaN 473.0 2.0 14.0 5.0 9.0 477.0 6.0 48.0 NaN 1.0 4.0 18.0 NaN 8.0 NaN
Hypertension 84.0 147.0 304.0 35.0 60.0 40.0 74.0 168.0 306.0 88.0 209.0 31.0 NaN NaN 2.0 14.0 5.0 9.0 477.0 6.0 42.0 NaN 1.0 1.0 19.0 NaN 7.0 NaN
Influenza_infection 86.0 142.0 303.0 35.0 59.0 39.0 72.0 152.0 304.0 88.0 206.0 32.0 NaN 460.0 NaN 14.0 5.0 9.0 474.0 6.0 42.0 NaN 1.0 1.0 17.0 NaN 7.0 NaN
Chronic_insomnia 74.0 147.0 284.0 35.0 57.0 40.0 73.0 148.0 302.0 88.0 203.0 31.0 NaN 461.0 2.0 NaN 5.0 9.0 456.0 6.0 41.0 NaN 1.0 1.0 17.0 NaN 7.0 NaN
Lewy_body_dementia 78.0 141.0 282.0 31.0 57.0 38.0 67.0 139.0 299.0 77.0 192.0 28.0 NaN 425.0 2.0 14.0 NaN 8.0 420.0 6.0 38.0 NaN 1.0 1.0 15.0 NaN 7.0 NaN
Loneliness 75.0 145.0 291.0 34.0 57.0 40.0 72.0 151.0 302.0 88.0 203.0 31.0 NaN 462.0 2.0 14.0 5.0 NaN 456.0 6.0 41.0 NaN 1.0 1.0 17.0 NaN 7.0 NaN
Age_at_which_the_menopause_started 77.0 143.0 290.0 36.0 54.0 37.0 71.0 147.0 301.0 87.0 204.0 31.0 NaN 463.0 2.0 14.0 5.0 9.0 NaN 6.0 40.0 NaN 1.0 1.0 18.0 NaN 7.0 NaN
Obesity 86.0 144.0 321.0 35.0 59.0 40.0 74.0 160.0 304.0 88.0 207.0 34.0 NaN 473.0 2.0 14.0 5.0 9.0 477.0 NaN 48.0 NaN 1.0 4.0 18.0 NaN 8.0 NaN
Parkinson_disease 86.0 145.0 311.0 35.0 59.0 40.0 74.0 160.0 304.0 88.0 207.0 33.0 NaN 472.0 2.0 14.0 5.0 9.0 477.0 6.0 NaN NaN 1.0 2.0 18.0 NaN 7.0 NaN
Pineapple_intake 14.0 49.0 53.0 4.0 10.0 3.0 6.0 23.0 41.0 12.0 48.0 3.0 NaN 80.0 1.0 NaN 1.0 1.0 84.0 2.0 8.0 NaN NaN NaN 2.0 NaN 1.0 NaN
Psychosocial_stress_measurement 83.0 145.0 302.0 35.0 60.0 40.0 74.0 165.0 305.0 88.0 208.0 31.0 NaN 476.0 2.0 14.0 5.0 9.0 477.0 6.0 43.0 NaN NaN 1.0 19.0 NaN 7.0 NaN
Skin_color 73.0 144.0 283.0 31.0 53.0 37.0 70.0 141.0 292.0 79.0 202.0 30.0 NaN 447.0 2.0 13.0 3.0 8.0 429.0 6.0 29.0 NaN 1.0 NaN 16.0 NaN 7.0 NaN
Stroke 82.0 145.0 302.0 35.0 58.0 40.0 73.0 163.0 303.0 88.0 206.0 31.0 NaN 468.0 2.0 14.0 5.0 9.0 477.0 6.0 41.0 NaN 1.0 1.0 NaN NaN 7.0 NaN
Vascular_dementia 15.0 47.0 49.0 4.0 10.0 3.0 5.0 22.0 43.0 12.0 48.0 3.0 NaN 82.0 1.0 NaN 1.0 1.0 84.0 2.0 8.0 NaN NaN NaN 2.0 NaN 1.0 NaN
Female_Infertility 87.0 145.0 319.0 35.0 60.0 40.0 75.0 168.0 306.0 88.0 209.0 34.0 NaN 482.0 2.0 14.0 5.0 9.0 477.0 6.0 46.0 NaN 1.0 4.0 19.0 NaN NaN NaN
Male_Infertility 87.0 145.0 319.0 35.0 60.0 40.0 74.0 168.0 306.0 88.0 209.0 34.0 NaN 482.0 2.0 14.0 5.0 9.0 477.0 6.0 46.0 NaN 1.0 5.0 19.0 NaN 8.0 NaN
"

# Step 1: Split into lines
lines <- strsplit(numSNP, "\n")[[1]]
# Remove empty lines
lines <- lines[lines != ""]

# Step 2: Split each line into fields (by space(s))
# Use strsplit with "\\s+" (one or more whitespace)
split_lines <- strsplit(lines, "\\s+")

# Step 3: Extract rownames and numeric matrix
rownames <- sapply(split_lines, `[`, 1)        # first element of each line
mat_data <- lapply(split_lines, function(x) x[-1])  # rest elements per line

# Step 4: Convert to numeric matrix, replacing "NaN" with NA
mat_numSNP <- do.call(rbind, lapply(mat_data, function(x) {
  as.numeric(ifelse(x == "NaN", NA, x))
}))

# Assign dimnames
dimnames(mat_numSNP) <- list(rownames, rownames)

# Now mat_numeric is a numeric matrix with row and col names

# Optional: Check structure
str(mat_numSNP)

##zscore
zscore <- "
Alzheimer's_Disease NaN -0.45067544028931383 0.09272861330327786 0.22538919922031056 -0.45984233846719447 -0.6517893896016392 -0.5224641908859707 -0.10198629003304505 -0.7020620365437946 -0.05306574672330036 0.5730134864510678 -1.316655535345831 NaN -0.5236522297622574 -0.6310891746506315 0.7134123620376107 71.21064778898466 0.20498915198115353 -0.14595277789771563 -2.512936028274736 2.765959190951588 NaN -0.607424672007744 -0.6608493287309535 -1.9551211319316943 NaN -1.4273808474693346 NaN
Diabetes_mellitus_type_1  0.1485715879996662 NaN -0.7212329372547935 0.10513587443876744 -0.9515547091608126 -0.35065709255098837 1.0984313161946815 0.4635744942323756 0.2531476124765546 0.6966547271286596 1.1448946332965353 2.0124637995179313 NaN 0.2001890532123992 0.6646374520893865 0.6923288317741032 -0.009496844245862302 0.2783798123795198 0.30216776586988103 -0.6516183366907147 3.0885547834388256 NaN 0.33864845983084546 -0.2531825492238085 33.32887358248687 NaN 0.44146336253110574 NaN
Diabetes_mellitus_type_2 0.5437471271985945 -1.4228782508615911 NaN 0.21855309432340123 -0.4634204092760716 -5.60816924527693 -1.0093315972222223 0.29203700275666916 -1.0243572155836498 0.6439996657306921 1.6136025378799315 -4.346155190639307 NaN -1.4466755636077964 -3.1210462896728495 -1.1999288918392437 -3.6798828262499246 -0.3960870686644913 -0.48043760452134743 -35.2623774985335 0.5240665028078407 NaN -3.3980258382929303 0.399714301031837 -84.4305038551956 NaN 1.353643079130022 NaN
Covid-19_infection -0.0014221828952715315 0.5019274968577994 0.02351249225565759 NaN 20.12756838140338 -0.0358336267295514 -0.40680024544111476 -0.5228750608510175 -0.11410584437774406 0.21628657286922828 0.25147262430539075 0.003265343000304677 NaN -0.21176250638410582 3.599152160276175 -0.3839473779061436 0.5108386153296591 1.0211097545631023 -0.1446952986202581 -1.9457391373729518 -1.1247890536229848 NaN -0.05425149940668905 1.03214389602357 1.2995609509858053 NaN 0.2014882370968547 NaN
Covid-19_Very_severe_respiratory_confirmed_covid_vs._population -0.06466267805862544 0.10595275054118383 0.10384244684972141 39.35651896428471 NaN -0.11219170153386876 -0.4052174190665258 0.06996797436750635 0.009852961210103955 -0.22360617345924697 0.4313122476314175 0.31969529025263677 NaN 0.016276084771447513 0.06423849857177952 -0.3707663179585742 -0.5991396882908467 -0.0788127885354694 -0.12036601744748408 -4.603179897400915 -0.9366704703333784 NaN -0.022431705614531113 0.44722511197627596 0.7040414490753781 NaN -0.10316024425102022 NaN
Sleep_apnea -0.267275293127489 -1.5691454394908897 -0.33833015288945567 0.14191076268345812 0.05231743638442421 NaN 0.3186593293728333 -0.1590743073558406 0.4161223307516675 -1.0887938446340715 -0.33782141057449055 0.3393532747253476 NaN 0.5422978147627626 0.8670972628844803 0.7034698841351713 -0.5780566612183213 -0.8259153844917655 -0.1574351647746913 4.134090575169793 -1.890153516157505 NaN -0.1302012947590776 NaN 0.9210623617944295 NaN 0.8984619799866417 NaN
Cigarrete_day -0.42373514739229023 0.31032894444444437 -0.5176575555555555 0.0013268263888889242 -0.3012938271604938 0.8335540000000001 NaN 0.5262737244897959 0.2995007812499999 -1.0236389455782313 -0.805201909722222 -0.8253013454861111 NaN 0.7997566597222221 -0.19217987499999997 2.086020138888889 -1.4824588842975206 0.29199027777777775 0.4366783472222221 12.043344444444445 0.013250611111111033 NaN 9.455625000000001 -1.10775625 0.2058524691358024 NaN -0.6864312499999999 NaN
Drink_Weekly 0.10024621913580245 -0.05746505578512398 0.5324486944444443 -0.18021199999999993 -0.62393125 -2.4828981874999996 1.40208125 NaN -0.11929722222222225 0.5930062500000001 0.17879175 0.036128937500000013 NaN -0.0548142499999999 0.3562888888888889 1.11798325 -0.2357716736111111 -0.983589 0.13060138888888886 -14.607956249999999 1.475886805555555 NaN -8.673025 -0.765625 -1.5137935486111112 NaN 3.4535907986111107 NaN
Coronary_artery_disease -1.331288235865961 0.1781552605786379 -1.9501048499353095 0.023448876212342373 0.7031203937655007 2.936675650397657 1.206748429634967 0.4731214738573195 NaN -1.8498442443130632 -0.0017512161905962054 33.87267875133415 NaN 4.103205333992616 -1.1503452441489743 2.0665222457606176 0.5839826415491918 -1.0271100619148517 0.06857281665222109 12.071547340806713 -0.7220828505879349 NaN 5.656391574215281 -0.4129551507887433 109.43767556358075 NaN -0.3490906314555693 NaN
Depressive_disorder 0.4661125016770745 2.790609278571921 0.3685603880797688 -0.0871932727023329 -0.5597156383931742 -2.0157775229480444 -0.6652061124055514 0.8577425960993869 -0.1218406297948244 NaN -1.005286940463357 0.648470014989208 NaN -0.750957003525533 1.2853350778281385 -3.0668833006749843 -0.09966491377655107 -9.838887461846896 0.12656432782611649 -0.2792958241731279 1.5161945553833778 NaN 0.643235412868227 0.48378396388172923 -0.359603204850021 NaN -0.14289636143652273 NaN
Diet 0.2938214462397938 -0.7038665084156652 0.10174405300492395 -0.272426965733361 0.41129325252415494 0.11870797053097604 1.2835420402964375 -0.5371710560104445 -0.5287875138892718 -2.128524831891566 NaN 0.21955379844630163 NaN -0.7326898579615193 0.4862661130370711 -0.3123852992676886 0.052580670333685055 1.5264689371549829 -0.40469391455197357 -49.05562978422731 -0.4297800489984628 NaN -0.692978354574006 1.4571687241527405 0.6299041066236006 NaN 0.31372480676758063 NaN
Heart_failure -0.7744235105578545 0.4642061529104244 -0.5783585018787285 -0.27101674882104304 -0.04915472292496975 2.7772657128174734 1.9490804825710122 0.10524626646968563 4.2713195406989435 -0.8347636379752296 -0.08101487408688973 NaN NaN 2.166159740673739 -0.22902456390174436 1.0727682528833131 3.0048734199976916 -0.19617687581181065 0.10134851542020268 19.111466473111008 -0.6213082743285597 NaN -1.1761555246974804 0.01261244888405448 9.402613285948911 NaN 0.0012711497987134557 NaN
HIV_infection -0.0425525161352201 -0.5364325494067683 0.01071562767827397 0.2860051428647932 0.07144555756237794 0.09739175024949195 0.12686537072885812 -0.041161573817892934 -0.039758568969811 -0.2119563519783903 0.1308124446563701 0.0375161692986018 NaN 0.0047113226579452855 1.0006083798190222 -0.10511434070969292 -0.1071754586328965 0.05496603223970367 -0.0909872755890527 2.9801692281622625 0.019826796570256367 NaN -0.499264943167557 0.12417304177346278 -0.03924727006695264 NaN -0.1751217436206495 NaN
Hypertension -0.5311971057965489 -1.783401393102741 -2.446734098833042 0.5225559085397395 0.09647038519586365 0.6834973929524826 0.8018390341669096 1.453154857157727 4.994448632678504 -0.03862471613959395 -1.7338642794063235 38.08229405532762 NaN NaN 0.41340903923392475 2.8339849842009315 1.4574134190040025 -4.567044521742997 -0.543157164423242 35.89181953839233 2.8999647969351767 NaN 0.5611104383051664 -0.39447755249224603 10.982880133443036 NaN 1.0462875824526727 NaN
Influenza_infection -0.4818050240225028 -0.2229148996959573 -0.33785800001227656 0.5347000215822211 0.4937102658012467 1.0270572870773802 0.23850634977926133 -0.11084130635727267 0.13662808897891174 -0.6227561049199297 -0.07598551595730743 -0.040571253436244084 NaN 0.48324657160518325 NaN 0.45934587875454197 0.025003483037367397 0.262222879937337 0.014366593717292014 0.8557779320858898 -0.7485417442793805 NaN 4.641680779007117 -2.5242066589254377 0.19641932466200812 NaN 0.09134154569596538 NaN
Chronic_insomnia -0.045698166750218594 -0.0521775256371612 -0.12542923911670079 0.1236862546651187 -0.2610555698731587 -1.1480739219907727 1.240312724179849 0.6368607561286446 0.16373762248009374 -2.032847146307825 0.19130844183733142 -0.012440364939685148 NaN -0.09867044623480675 1.1500260275964331 NaN -0.9912712087102613 2.820733066972365 0.2018104368996962 -2.767871889263074 0.5670966414340278 NaN 0.5409886244057489 -0.09846578268280735 0.07959433459740181 NaN -2.769125972626752 NaN
Lewy_body_dementia 1.6662458183870648 0.08527884191130836 -0.0107155539046178 -0.013549352692110161 0.32567175821240096 -0.597098719215057 0.13755594699501567 0.09943049435261797 0.13072004113032965 0.03007014927018173 -0.001315474905370817 0.43431223422718984 NaN -0.050065317630992354 -0.387870678945485 0.20032997187018173 NaN -0.8582568308325481 0.06960703570962999 -0.05435714118126338 1.8908466551067828 NaN 0.32330809252300174 0.23035083382780647 0.1504642309616039 NaN 0.17685325952099054 NaN
Loneliness -0.01319252642379859 -0.8290831013972518 -0.12574884484235188 0.1115384114932503 0.05576578331558063 0.4164922335745374 0.22623553984259645 -0.31769822318424645 0.09783007872738825 -11.744511894244873 0.1509762273156046 -1.7962531653484881 NaN 0.04295525238673502 -0.6556492917861979 1.9014883286176079 0.3738834490083387 NaN 0.1537341119900515 3.8572840992896666 -0.7277559271966232 NaN -0.0516345520770852 -0.7347263436794879 -0.06013932858797011 NaN 0.0034635283174661857 NaN
Age_at_which_the_menopause_started 0.10252202977214664 2.749400237399131 0.733561838975398 0.47002980540704875 0.6203966678663371 -0.6873238628227101 1.9816097663725247 0.8356028980421415 0.2726733928996887 -1.3682929122528629 -0.3633244387237675 0.3793546781031002 NaN 0.9948479122973427 0.2692552267465378 1.5931880069309696 0.3426296715041419 -0.6085080659862903 NaN 0.7436545342979406 -1.861570578222224 NaN -1.491134849989944 1.256604414858538 -0.2006000282784171 NaN 3.1429208435943936 NaN
Obesity -0.21382724991872787 -0.18694502612184738 -0.32474354602093747 1.601071420614386E-4 0.9432698639158983 4.552235067812807 1.0923694790894933 -0.006565127745494281 0.5605156638640364 -1.3293830689569008 -1.4282946538800705 1.1360635586408214 NaN 0.8952202025637839 0.5457322317790856 0.8863998636001393 -0.35655356760368934 -0.3294516838209819 0.1364966261550587 NaN -1.6351523078291792 NaN -0.2112284460769309 -0.5696431771970039 -0.1882748766866783 NaN -0.004617784161047977 NaN
Parkinson_disease 0.1638166847746232 0.028408267644682864 -0.05932738423902656 0.24135292096265631 -0.5191662801760623 -0.960540635187358 -0.22449069602793284 0.3995161401342478 -0.14676927329246786 0.3507485529747509 -0.004219012035654696 -0.08197486175967478 NaN -0.07387452352930875 0.8612451658848949 0.33181013485690036 33.73119030674047 -1.95874774580376 0.030824670744004468 -0.022480701177383156 NaN NaN 5.790516502897457 4.320343568572371 0.006383139359465738 NaN -0.24634632496632927 NaN
Pineapple_intake 0.42904486640385187 0.05982195033860224 0.0450769037849701 0.2776814243109069 0.232032204809872 0.7592408207549175 0.7545260073190208 0.005864313940392316 0.0306653463584027 -0.02504648448033265 0.007371052725302155 -0.28094812104986594 NaN 0.08746917959804228 0.26304536594985145 NaN -1.1852061435894334 0.06982101321938725 0.02121751021733717 0.19628373850200453 0.004505082270851529 NaN NaN NaN -0.019368105985914038 NaN 1.2006917029456614 NaN
Psychosocial_stress_measurement 0.2195569308473299 -0.077806616162517 -0.10611904941002517 0.25953933878298524 0.6172690644147192 1.3340369810833932 0.23123596115477438 0.3425034455822096 0.35582958400521264 -2.1381605923430547 0.44634561053363864 0.11409555708486284 NaN 0.19818614221752204 -0.6926764945220547 0.1923400555492116 -0.7438612017912481 4.213809437418004 -0.07783957889330684 -0.1419581878725858 -0.4093988205724199 NaN NaN -0.9612363174955013 0.7289340509074207 NaN 0.2157928989133709 NaN
Skin_color -0.14392331996766808 -0.02802713552493813 -0.04572010816633687 0.13319408516285638 -0.10302359726246038 -0.08279386853664511 0.20905101202763848 0.01827339672574596 0.03678257357848756 -0.22529632430567476 0.21807902682415375 0.5695709930754345 NaN -0.010521787646409875 5.4836071830970425 0.39879032804515113 0.13699920513158317 0.6130379104093413 0.020930185507647428 -0.5588306816038043 -0.22444889885852276 NaN -8.008809522977614 NaN 0.7320369955036615 NaN -0.10992361555059975 NaN
Stroke -0.6957831915746581 1.1590009051598102 -4.680635146724147 0.16582664057486304 0.3829293388071558 2.9104023096565097 1.0135461624126723 -0.02680064355607406 4.351522825864943 -0.6425525547432503 -0.16434480004984986 11.924474148810681 NaN 1.6246443919965077 0.9714612030549237 0.37628871187691265 1.1495746822603476 0.05435640123004412 0.2720525876010645 3.582930336317444 -0.9667631742564327 NaN 2.47718944089175 -0.0010073592430296229 NaN NaN -0.5978302549994869 NaN
Vascular_dementia 0.061753458057808325 -0.10220937557062093 -0.046852851842171736 0.14031739548793992 0.07773608308256302 -0.5359531207319652 0.012843449430522211 -0.09140072448064247 0.013620620294624741 -0.06649812307157267 0.03449150646245472 -0.029542335795845524 NaN 0.02888819681584413 2.3871068429616695 NaN 0.9607381500689992 0.3464675315350585 0.01591656680388101 0.19558567976956787 -0.02272765981542535 NaN NaN NaN -0.5383709702950953 NaN -1.0257484407595499 NaN
Female_Infertility 0.18553755074542222 0.12623093659503126 -0.12666068147031906 0.9070521290520869 0.1300114370704887 -0.20509871994718282 -0.03758497979917187 0.016584913772914905 0.15214185409600572 -0.2962073635765943 -0.03288623844704597 -0.26311343546373517 NaN -0.007874145814252581 0.4583571738644706 0.6509166884639108 0.4171248215671599 -1.048003516308753 -0.3356553764055853 -0.7895014977557608 0.27845745691755397 NaN 0.8032217871128516 -0.19510849579374437 -0.5058752369161782 NaN NaN NaN
Male_Infertility -0.2551475251743686 0.06558857997716952 0.04905261392113568 0.041652738846831475 0.20624682993587262 0.38236323840726555 0.08911416182022243 -0.15705578462429742 0.013631588533116967 -0.3528557879952024 -0.20985217699953268 -0.5085106819763009 NaN 0.04058606826399287 0.031683043587805465 0.27665602242008286 0.0056403659650120855 0.13690759449785422 0.11058210642885294 -0.36736914595728865 -0.3827138824093379 NaN 1.09750566893424 -0.11647242473101029 -0.984802616189597 NaN -0.15864816370555934 NaN
"

# Step 1: Split into lines
lines <- strsplit(zscore, "\n")[[1]]
# Remove empty lines
lines <- lines[lines != ""]

# Step 2: Split each line into fields (by space(s))
# Use strsplit with "\\s+" (one or more whitespace)
split_lines <- strsplit(lines, "\\s+")

# Step 3: Extract rownames and numeric matrix
rownames <- sapply(split_lines, `[`, 1)        # first element of each line
mat_data <- lapply(split_lines, function(x) x[-1])  # rest elements per line

# Step 4: Convert to numeric matrix, replacing "NaN" with NA
mat_zscore <- do.call(rbind, lapply(mat_data, function(x) {
  as.numeric(ifelse(x == "NaN", NA, x))
}))

# Assign dimnames
dimnames(mat_zscore) <- list(rownames, rownames)

# Now mat_numeric is a numeric matrix with row and col names

# Optional: Check structure
str(mat_zscore)


##pval
pval <- "
Alzheimer's_Disease NaN 1.0 0.025 0.088 1.0 1.0 1.0 0.939 1.0 0.779 0.0 1.0 NaN 1.0 0.883 0.024 0.0 0.236 1.0 1.0 0.0 NaN 0.776 0.818 1.0 NaN 0.99 NaN
Diabetes_mellitus_type_1  0.079 NaN 1.0 0.264 1.0 0.981 0.0 0.0 0.0 0.0 0.0 0.0 NaN 0.0 0.313 0.029 0.749 0.168 0.0 0.927 0.0 NaN 0.286 0.695 0.0 NaN 0.445 NaN
Diabetes_mellitus_type_2 0.0 1.0 NaN 0.104 0.999 1.0 1.0 0.001 1.0 0.0 0.0 1.0 NaN 1.0 0.989 0.999 1.0 0.877 1.0 1.0 0.004 NaN 0.945 0.289 1.0 NaN 0.035 NaN
Covid-19_infection 0.499 0.0 0.313 NaN 0.0 0.696 1.0 1.0 0.985 0.021 0.0 0.491 NaN 1.0 0.041 0.931 0.119 0.006 1.0 0.999 1.0 NaN 0.565 0.211 0.001 NaN 0.31 NaN
Covid-19_Very_severe_respiratory_confirmed_covid_vs._population 0.75 0.065 0.022 0.0 NaN 0.844 1.0 0.178 0.415 0.986 0.0 0.043 NaN 0.341 0.531 0.922 0.901 0.623 0.999 1.0 1.0 NaN 0.566 0.261 0.009 NaN 0.618 NaN
Sleep_apnea 0.983 1.0 1.0 0.279 0.428 NaN 0.009 0.98 0.0 1.0 1.0 0.044 NaN 0.0 0.305 0.026 0.891 0.95 0.998 0.001 1.0 NaN 0.627 NaN 0.006 NaN 0.052 NaN
Cigarrete_day 1.0 0.0 1.0 0.572 0.993 0.0 NaN 0.0 0.0 1.0 1.0 0.999 NaN 0.0 0.724 0.0 0.975 0.184 0.0 0.0 0.469 NaN 0.005 0.855 0.21 NaN 0.91 NaN
Drink_Weekly 0.204 0.775 0.0 0.891 1.0 1.0 0.0 NaN 0.977 0.0 0.005 0.431 NaN 0.895 0.429 0.007 0.749 0.982 0.005 1.0 0.0 NaN 0.994 0.76 1.0 NaN 0.0 NaN
Coronary_artery_disease 1.0 0.012 1.0 0.453 0.0 0.0 0.0 0.0 NaN 1.0 0.519 0.0 NaN 0.0 0.934 0.0 0.108 0.991 0.036 0.0 1.0 NaN 0.013 0.709 0.0 NaN 0.79 NaN
Depressive_disorder 0.0 0.0 0.0 0.713 1.0 1.0 1.0 0.0 0.979 NaN 1.0 0.005 NaN 1.0 0.202 1.0 0.621 1.0 0.01 0.766 0.0 NaN 0.253 0.386 0.9 NaN 0.612 NaN
Diet 0.027 1.0 0.049 0.908 0.006 0.331 0.0 1.0 1.0 1.0 NaN 0.165 NaN 1.0 0.371 0.837 0.451 0.005 1.0 1.0 0.989 NaN 0.782 0.137 0.027 NaN 0.258 NaN
Heart_failure 1.0 0.0 1.0 0.932 0.655 0.0 0.0 0.072 0.0 1.0 0.897 NaN NaN 0.0 0.754 0.006 0.0 0.73 0.011 0.0 0.999 NaN 0.842 0.483 0.0 NaN 0.502 NaN
HIV_infection 0.951 1.0 0.198 0.001 0.032 0.048 0.0 0.989 0.996 1.0 0.0 0.21 NaN 0.307 0.122 0.906 0.816 0.264 1.0 0.001 0.358 NaN 0.867 0.435 0.743 NaN 0.962 NaN
Hypertension 1.0 1.0 1.0 0.009 0.364 0.003 0.0 0.0 0.0 0.689 1.0 0.0 NaN NaN 0.411 0.0 0.031 1.0 1.0 0.0 0.0 NaN 0.271 0.706 0.0 NaN 0.061 NaN
Influenza_infection 1.0 0.999 1.0 0.003 0.003 0.0 0.023 0.946 0.005 1.0 0.884 0.7 NaN 0.0 NaN 0.057 0.453 0.207 0.351 0.08 1.0 NaN 0.016 0.938 0.183 NaN 0.408 NaN
Chronic_insomnia 0.702 0.742 0.983 0.235 0.972 1.0 0.0 0.0 0.005 1.0 0.009 0.539 NaN 0.987 0.217 NaN 0.953 0.001 0.0 1.0 0.0 NaN 0.235 0.601 0.33 NaN 0.999 NaN
Lewy_body_dementia 0.0 0.094 0.566 0.544 0.005 1.0 0.095 0.097 0.003 0.37 0.563 0.028 NaN 0.905 0.82 0.221 NaN 0.992 0.043 0.615 0.0 NaN 0.28 0.329 0.258 NaN 0.325 NaN
Loneliness 0.571 1.0 0.979 0.267 0.323 0.023 0.052 0.999 0.034 1.0 0.018 1.0 NaN 0.171 0.853 0.0 0.189 NaN 0.0 0.0 1.0 NaN 0.59 0.786 0.597 NaN 0.489 NaN
Age_at_which_the_menopause_started 0.374 0.0 0.0 0.216 0.06 0.933 0.0 0.0 0.048 1.0 0.974 0.222 NaN 0.0 0.594 0.033 0.37 0.765 NaN 0.322 1.0 NaN 0.753 0.285 0.687 NaN 0.008 NaN
Obesity 0.981 0.997 1.0 0.469 0.0 0.0 0.0 0.568 0.0 1.0 1.0 0.0 NaN 0.0 0.332 0.007 0.817 0.848 0.0 NaN 1.0 NaN 0.669 0.953 0.825 NaN 0.709 NaN
Parkinson_disease 0.027 0.33 0.934 0.039 1.0 1.0 0.992 0.0 0.999 0.0 0.534 0.753 NaN 0.99 0.213 0.115 0.0 1.0 0.172 0.552 NaN NaN 0.01 0.018 0.503 NaN 0.772 NaN
Pineapple_intake 0.02 0.214 0.275 0.39 0.132 0.041 0.033 0.488 0.358 0.694 0.533 0.733 NaN 0.102 0.269 NaN 0.929 0.399 0.41 0.421 0.681 NaN NaN NaN 0.608 NaN 0.093 NaN
Psychosocial_stress_measurement 0.023 0.862 0.98 0.062 0.0 0.0 0.021 0.0 0.0 1.0 0.0 0.243 NaN 0.0 0.878 0.255 0.933 0.0 0.97 0.702 0.997 NaN NaN 0.836 0.003 NaN 0.292 NaN
Skin_color 0.873 0.688 0.766 0.288 0.748 0.651 0.082 0.412 0.302 0.957 0.003 0.015 NaN 0.6 0.019 0.117 0.433 0.187 0.338 0.878 0.856 NaN 0.994 NaN 0.054 NaN 0.618 NaN
Stroke 1.0 0.0 1.0 0.16 0.006 0.0 0.0 0.635 0.0 1.0 0.997 0.0 NaN 0.0 0.232 0.117 0.033 0.429 0.0 0.0 1.0 NaN 0.07 0.497 NaN NaN 0.906 NaN
Vascular_dementia 0.293 0.958 0.804 0.492 0.28 0.918 0.463 0.889 0.424 0.841 0.329 0.515 NaN 0.27 0.009 NaN 0.085 0.147 0.381 0.364 0.771 NaN NaN NaN 0.942 NaN 0.921 NaN
Female_Infertility 0.027 0.029 0.996 0.0 0.175 0.955 0.631 0.434 0.0 0.998 0.724 0.959 NaN 0.614 0.335 0.022 0.151 0.995 1.0 0.962 0.028 NaN 0.192 0.857 0.972 NaN NaN NaN
Male_Infertility 0.998 0.144 0.144 0.382 0.048 0.01 0.173 0.997 0.36 0.999 0.999 0.998 NaN 0.14 0.562 0.146 0.483 0.298 0.002 0.866 0.995 NaN 0.155 0.657 1.0 NaN 0.838 NaN
"

# Step 1: Split into lines
lines <- strsplit(pval, "\n")[[1]]
# Remove empty lines
lines <- lines[lines != ""]

# Step 2: Split each line into fields (by space(s))
# Use strsplit with "\\s+" (one or more whitespace)
split_lines <- strsplit(lines, "\\s+")

# Step 3: Extract rownames and numeric matrix
rownames <- sapply(split_lines, `[`, 1)        # first element of each line
mat_data <- lapply(split_lines, function(x) x[-1])  # rest elements per line

# Step 4: Convert to numeric matrix, replacing "NaN" with NA
mat_pval <- do.call(rbind, lapply(mat_data, function(x) {
  as.numeric(ifelse(x == "NaN", NA, x))
}))

# Assign dimnames
dimnames(mat_pval) <- list(rownames, rownames)

# Now mat_numeric is a numeric matrix with row and col names

# Optional: Check structure
str(mat_pval)


### NMDS projection
library(smacof)
library(ggplot2)
library(ggrepel)

#for pval
# Ensure the matrix is symmetric and no missing values
dist_pval <- as.matrix(mat_pval)
dist_pval[is.na(dist_pval)] <- max(dist_pval, na.rm = TRUE)  # Replace NA with max dissimilarity

# Run NMDS using smacof
nmds_pval  <- smacofSym(dist_pval, ndim = 2, type = "ordinal", ties = "tertiary")

message("NMDS stress: ", nmds_pval$stress)

#coordinate
pval_coords <- as.data.frame(nmds_pval$conf)
colnames(pval_coords) <- c("Dim1", "Dim2")
pval_coords$Trait <- rownames(pval_coords)

pval_coords$IsAD <- pval_coords$Trait == "Alzheimer's_Disease"

# Plot
p <- ggplot(pval_coords, aes(x = Dim1, y = Dim2)) +
  #all points, gray; AD in red
  geom_point(aes(color = IsAD), size = 3, alpha = 0.8) +
  scale_color_manual(values = c("FALSE" = "grey50", "TRUE" = "firebrick"),
                     guide = FALSE) +
  # Only label non-AD traits here
  geom_text_repel(
    data = subset(pval_coords, !IsAD),
    aes(label = Trait),
    size = 3,
    max.overlaps = 30,
    segment.size = 0.2
  ) +
  # Label AD separately and in red/bold
  geom_text_repel(
    data = subset(pval_coords, IsAD),
    aes(label = Trait),
    size = 4,
    fontface = "bold",
    color = "firebrick",
    nudge_y = 0.1,
    segment.color = "firebrick"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "grey90"),
    panel.grid.minor = element_blank(),
    axis.title     = element_text(face = "bold"),
    plot.subtitle  = element_text(face = "italic")
  ) +
  labs(
    title    = "Non metric MDS of Trait Similarities for p < 1e-8 (P-value based)",
    x        = "MDS Dimension 1",
    y        = "MDS Dimension 2"
  )

p

#for zscore
# Replace NA with 0 or a safe default
mat_zscore[is.na(mat_zscore)] <- 0

# Convert similarity â†’ dissimilarity (subtract from max)
diss_zscore <- max(mat_zscore) - mat_zscore

# Run NMDS using smacof
nmds_zscore  <- smacofSym(diss_zscore, ndim = 2, type = "ordinal", ties = "tertiary")

message("NMDS stress: ", nmds_zscore$stress)

#coordinate
zscore_coords <- as.data.frame(nmds_zscore$conf)
colnames(zscore_coords) <- c("Dim1", "Dim2")
zscore_coords$Trait <- rownames(zscore_coords)

zscore_coords$IsAD <- zscore_coords$Trait == "Alzheimer's_Disease"

# Plot
q <- ggplot(zscore_coords, aes(x = Dim1, y = Dim2)) +
  #all points, gray; AD in red
  geom_point(aes(color = IsAD), size = 3, alpha = 0.8) +
  scale_color_manual(values = c("FALSE" = "grey50", "TRUE" = "firebrick"),
                     guide = FALSE) +
  # Only label non-AD traits here
  geom_text_repel(
    data = subset(zscore_coords, !IsAD),
    aes(label = Trait),
    size = 3,
    max.overlaps = 30,
    segment.size = 0.2
  ) +
  # Label AD separately and in red/bold
  geom_text_repel(
    data = subset(zscore_coords, IsAD),
    aes(label = Trait),
    size = 4,
    fontface = "bold",
    color = "firebrick",
    nudge_y = 0.1,
    segment.color = "firebrick"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "grey90"),
    panel.grid.minor = element_blank(),
    axis.title     = element_text(face = "bold"),
    plot.subtitle  = element_text(face = "italic")
  ) +
  labs(
    title    = "Non metric MDS of Trait Similarities for p < 1e-8 (Z-score based)",
    x        = "MDS Dimension 1",
    y        = "MDS Dimension 2"
  )

q

##clustering
library(mclust)
library(dbscan)
library(RColorBrewer)

coords <- pval_coords[, c("Dim1", "Dim2")]
rownames(coords) <- pval_coords$Trait

#mclust
set.seed(42) 
mclust_res <- Mclust(coords)
pval_coords$MclustCluster <- factor(mclust_res$classification)

#dbscan
kNNdistplot(coords, k = 4)
db_res <- dbscan(coords, eps = 0.55, minPts = 4)
pval_coords$DBSCANcluster <- factor(db_res$cluster)

# Create label column
pval_coords$Label <- pval_coords$Trait

# Identify AD index
ad_idx <- which(pval_coords$IsAD)

# --- PLOT MCLUST ---
ggplot(pval_coords, aes(x = Dim1, y = Dim2, color = MclustCluster)) +
  scale_color_brewer(palette = "Set2", na.value = "grey50", name = "Cluster", drop = TRUE, na.translate = FALSE) +
  geom_point(size = 4) +
  # AD outline
  geom_point(data = pval_coords[ad_idx, ], aes(x = Dim1, y = Dim2),
             color = "darkblue", size = 8, shape = 1, stroke = 1.5, inherit.aes = FALSE, show.legend = FALSE) +
  # other labels
  geom_text(data = pval_coords[-ad_idx, ], aes(label = Label),
            size = 3, hjust = 0.5, vjust = -0.7, show.legend = FALSE) +
  # AD label
  geom_text(data = pval_coords[ad_idx, ], aes(label = Label),
            size = 5, fontface = "bold", hjust = 0.5, vjust = -0.7,
            colour = "darkblue", show.legend = FALSE) +
  labs(title = "MCLUST Clustering on NMDS Projection (p-value Matrix)") +
  theme_bw() +
  theme(legend.position = "right")

# --- PLOT DBSCAN ---
ggplot(pval_coords, aes(x = Dim1, y = Dim2, color = DBSCANcluster)) +
  scale_color_brewer(palette = "Set2", na.value = "grey50", name = "Cluster", drop = TRUE, na.translate = FALSE) +
  geom_point(size = 4) +
  geom_point(data = pval_coords[ad_idx, ], aes(x = Dim1, y = Dim2),
             color = "darkblue", size = 8, shape = 1, stroke = 1.5, inherit.aes = FALSE, show.legend = FALSE) +
  geom_text(data = pval_coords[-ad_idx, ], aes(label = Label),
            size = 3, hjust = 0.5, vjust = -0.7, show.legend = FALSE) +
  geom_text(data = pval_coords[ad_idx, ], aes(label = Label),
            size = 5, fontface = "bold", hjust = 0.5, vjust = -0.7,
            colour = "darkblue", show.legend = FALSE) +
  labs(title = "DBSCAN Clustering on NMDS Projection (p-value Matrix)") +
  theme_bw() +
  theme(legend.position = "right")

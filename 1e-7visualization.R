##numSNP
numSNP <- "
Alzheimer's_Disease NaN 165.0 428.0 46.0 78.0 70.0 122.0 268.0 415.0 159.0 284.0 58.0 NaN 668.0 2.0 33.0 8.0 21.0 576.0 14.0 59.0 NaN 3.0 18.0 24.0 NaN 13.0 4.0
Diabetes_mellitus_type_1  95.0 NaN 372.0 38.0 68.0 70.0 115.0 241.0 396.0 151.0 273.0 50.0 NaN 637.0 2.0 32.0 7.0 21.0 500.0 10.0 45.0 NaN 2.0 5.0 22.0 NaN 7.0 NaN
Diabetes_mellitus_type_2 119.0 166.0 NaN 46.0 78.0 71.0 123.0 274.0 416.0 156.0 288.0 59.0 NaN 672.0 2.0 33.0 8.0 21.0 578.0 14.0 55.0 NaN 3.0 9.0 24.0 NaN 15.0 4.0
Covid-19_infection 117.0 166.0 418.0 NaN 78.0 71.0 123.0 275.0 416.0 158.0 289.0 56.0 NaN 672.0 2.0 33.0 8.0 21.0 578.0 13.0 54.0 NaN 3.0 8.0 24.0 NaN 12.0 2.0
Covid-19_Very_severe_respiratory_confirmed_covid_vs._population 113.0 164.0 411.0 46.0 NaN 71.0 121.0 272.0 416.0 158.0 286.0 56.0 NaN 670.0 2.0 33.0 8.0 21.0 575.0 11.0 53.0 NaN 2.0 7.0 24.0 NaN 13.0 2.0
Sleep_apnea 100.0 162.0 367.0 43.0 74.0 NaN 114.0 241.0 393.0 154.0 267.0 51.0 NaN 631.0 2.0 32.0 8.0 18.0 525.0 9.0 46.0 NaN 2.0 4.0 20.0 NaN 10.0 NaN
Cigarrete_day 119.0 164.0 421.0 46.0 79.0 70.0 NaN 276.0 413.0 154.0 286.0 56.0 NaN 668.0 2.0 33.0 8.0 21.0 575.0 13.0 54.0 NaN 2.0 8.0 24.0 NaN 12.0 2.0
Drink_Weekly 119.0 164.0 420.0 46.0 78.0 70.0 123.0 NaN 413.0 154.0 286.0 54.0 NaN 662.0 2.0 33.0 8.0 21.0 575.0 13.0 54.0 NaN 2.0 7.0 24.0 NaN 12.0 2.0
Coronary_artery_disease 121.0 166.0 431.0 46.0 79.0 71.0 124.0 274.0 NaN 158.0 288.0 56.0 NaN 676.0 2.0 33.0 8.0 21.0 578.0 14.0 58.0 NaN 3.0 15.0 24.0 NaN 12.0 4.0
Depressive_disorder 106.0 164.0 395.0 45.0 74.0 71.0 116.0 253.0 408.0 NaN 278.0 57.0 NaN 651.0 2.0 33.0 8.0 21.0 567.0 11.0 54.0 NaN 3.0 10.0 23.0 NaN 13.0 2.0
Diet 115.0 168.0 415.0 46.0 78.0 71.0 122.0 274.0 416.0 158.0 NaN 55.0 NaN 676.0 2.0 33.0 8.0 21.0 578.0 13.0 53.0 NaN 3.0 6.0 24.0 NaN 12.0 2.0
Heart_failure 116.0 163.0 449.0 45.0 76.0 71.0 123.0 273.0 413.0 158.0 284.0 NaN NaN 670.0 2.0 33.0 8.0 21.0 554.0 11.0 56.0 NaN 2.0 24.0 24.0 NaN 14.0 1.0
HIV_infection 120.0 165.0 432.0 46.0 77.0 71.0 120.0 265.0 414.0 159.0 281.0 61.0 NaN 666.0 2.0 33.0 8.0 21.0 578.0 14.0 63.0 NaN 3.0 20.0 24.0 NaN 15.0 4.0
Hypertension 115.0 168.0 415.0 46.0 78.0 71.0 122.0 274.0 416.0 158.0 289.0 55.0 NaN NaN 2.0 33.0 8.0 21.0 578.0 13.0 53.0 NaN 3.0 6.0 24.0 NaN 12.0 2.0
Influenza_infection 115.0 164.0 405.0 46.0 77.0 71.0 120.0 252.0 412.0 159.0 281.0 56.0 NaN 658.0 NaN 33.0 8.0 21.0 576.0 13.0 52.0 NaN 2.0 5.0 24.0 NaN 12.0 2.0
Chronic_insomnia 103.0 168.0 382.0 44.0 74.0 71.0 118.0 248.0 410.0 158.0 278.0 56.0 NaN 654.0 2.0 NaN 8.0 21.0 548.0 10.0 52.0 NaN 2.0 5.0 23.0 NaN 12.0 NaN
Lewy_body_dementia 106.0 163.0 373.0 42.0 74.0 68.0 113.0 240.0 397.0 146.0 265.0 53.0 NaN 613.0 2.0 31.0 NaN 19.0 515.0 10.0 48.0 NaN 2.0 4.0 20.0 NaN 11.0 NaN
Loneliness 103.0 167.0 391.0 44.0 74.0 71.0 120.0 248.0 407.0 158.0 281.0 55.0 NaN 657.0 2.0 33.0 8.0 NaN 549.0 10.0 52.0 NaN 2.0 5.0 22.0 NaN 12.0 NaN
Age_at_which_the_menopause_started 107.0 165.0 394.0 46.0 73.0 70.0 119.0 246.0 406.0 158.0 280.0 53.0 NaN 653.0 2.0 33.0 8.0 21.0 NaN 12.0 51.0 NaN 2.0 4.0 24.0 NaN 12.0 2.0
Obesity 120.0 165.0 432.0 46.0 77.0 71.0 120.0 265.0 414.0 159.0 281.0 62.0 2.0 666.0 2.0 33.0 8.0 21.0 578.0 NaN 63.0 NaN 3.0 20.0 24.0 NaN 15.0 4.0
Parkinson_disease 120.0 166.0 421.0 46.0 77.0 71.0 120.0 265.0 414.0 158.0 280.0 58.0 NaN 665.0 2.0 33.0 8.0 21.0 578.0 14.0 NaN NaN 3.0 12.0 24.0 NaN 15.0 4.0
Pineapple_intake 22.0 54.0 68.0 4.0 14.0 10.0 12.0 38.0 56.0 20.0 64.0 5.0 NaN 119.0 1.0 3.0 1.0 3.0 107.0 2.0 11.0 NaN NaN 1.0 3.0 3.0 1.0 NaN
Psychosocial_stress_measurement 113.0 167.0 413.0 46.0 78.0 71.0 121.0 271.0 415.0 159.0 287.0 55.0 NaN 668.0 2.0 33.0 8.0 21.0 578.0 13.0 54.0 NaN NaN 6.0 24.0 NaN 12.0 2.0
Skin_color 99.0 162.0 374.0 40.0 69.0 66.0 118.0 239.0 393.0 142.0 271.0 50.0 NaN 630.0 2.0 32.0 6.0 19.0 501.0 10.0 42.0 NaN 2.0 NaN 20.0 NaN 10.0 NaN
Stroke 112.0 166.0 412.0 46.0 76.0 71.0 120.0 265.0 410.0 158.0 285.0 55.0 NaN 663.0 2.0 33.0 8.0 21.0 578.0 13.0 52.0 NaN 3.0 6.0 NaN NaN 12.0 2.0
Vascular_dementia 23.0 51.0 67.0 4.0 13.0 9.0 11.0 40.0 58.0 19.0 62.0 6.0 NaN 121.0 1.0 3.0 1.0 2.0 106.0 2.0 11.0 1.0 NaN 1.0 2.0 NaN 1.0 NaN
Female_Infertility 123.0 166.0 434.0 46.0 79.0 71.0 124.0 274.0 416.0 158.0 289.0 62.0 1.0 676.0 2.0 33.0 8.0 21.0 578.0 14.0 61.0 NaN 3.0 23.0 24.0 NaN NaN 4.0
Male_Infertility 121.0 166.0 434.0 46.0 79.0 71.0 123.0 274.0 416.0 158.0 289.0 62.0 1.0 676.0 2.0 33.0 8.0 21.0 578.0 14.0 61.0 NaN 3.0 22.0 24.0 NaN 16.0 NaN
"

# Step 1: Split into lines
lines <- strsplit(numSNP, "\n")[[1]]
# Remove empty lines
lines <- lines[lines != ""]

# Step 2: Split each line into fields (by space(s))
# Use strsplit with "\\s+" (one or more whitespace)
split_lines <- strsplit(lines, "\\s+")

# Step 3: Extract rownames and numeric matrix
rownames <- sapply(split_lines, `[`, 1)        # first element of each line
mat_data <- lapply(split_lines, function(x) x[-1])  # rest elements per line

# Step 4: Convert to numeric matrix, replacing "NaN" with NA
mat_numSNP <- do.call(rbind, lapply(mat_data, function(x) {
  as.numeric(ifelse(x == "NaN", NA, x))
}))

# Assign dimnames
dimnames(mat_numSNP) <- list(rownames, rownames)

# Now mat_numeric is a numeric matrix with row and col names

# Optional: Check structure
str(mat_numSNP)

##zscore
zscore <- "
Alzheimer's_Disease NaN -0.40763161787824587 0.07599494289535114 0.31104030431192686 -0.172760671207044 -0.03501853137582206 -0.4836261218827613 -0.2573745031731706 -0.5372105470705922 -0.10841670303822731 0.3275187468579299 -0.8129439897611868 NaN -0.43958803986139705 -0.6310891746506315 0.372287347844706 69.2434502779596 -0.09979817736702506 -0.08299044668418559 -1.7971760118597353 2.6538134950020322 NaN -0.07864622570257546 0.007340660756906259 -1.0099814920988193 NaN -0.4675584400065373 -0.8124664307202942
Diabetes_mellitus_type_1  0.30901985198275794 NaN -0.7194040921709832 0.12905934657438584 -0.7842595043516762 -0.3159681077810509 0.7865233679355219 0.05471520893434015 0.24198147384753588 0.1532754624442162 0.25779134915129254 1.445046224089944 NaN 0.1703810312763628 0.6646374520893865 0.5392401067826972 -0.009496844245862302 0.10373307601608636 0.23060109024312778 -2.2601312184236426 0.9897435151621405 NaN 1.9587297374786465 -0.11873445335004609 43.96092075461166 NaN -0.7343385033971698 NaN
Diabetes_mellitus_type_2 0.39054300974054795 -1.3720217595245234 NaN 0.2753801549297601 -0.367642718797738 -2.592695977831113 -1.0734864847475047 0.04253399000525526 -0.9894168154924918 0.8242866254296963 0.9272158804623724 -4.3132277781386215 NaN -1.5398334981125827 -3.1210462896728495 -0.6663931585851834 -1.6032425398803583 -0.45951119698372456 -0.4402669270833335 -4.413117723619718 0.5240665028078407 NaN -7.689583936644779 -0.258083028344528 -62.226099014308645 NaN 1.0037927557043762 0.14307333197817654
Covid-19_infection -0.09230766889484421 0.4477861592591697 0.08449249487807405 NaN 15.606520809425827 -0.15113840851551594 -0.2765197887976553 -0.3781953175157001 -0.1072351981478775 0.056835080280570244 0.17102240791431383 -0.4897776174283033 NaN -0.1464417446674821 3.599152160276175 -0.4728160500392944 0.26312518758004005 0.41512139483834615 -0.1411263000695453 -1.905242995981521 -0.8303690672317652 NaN -2.355044404789865 0.36673836334665993 1.9547598720929513 NaN 0.19284569169314622 0.03933615863557645
Covid-19_Very_severe_respiratory_confirmed_covid_vs._population -0.07327191300721538 0.10595275054118383 0.18712506092819858 25.289680382530637 NaN -0.28120446102755553 -0.3421526359873755 -0.059757356515335425 0.007776468672878539 -0.11556836480718263 0.3878863029550209 -0.30077542633500953 NaN 0.047402356693357794 0.06423849857177952 -0.26172881980912366 0.07776824575357494 -0.00755351170572896 -0.1244549739639416 -1.797863947351929 -0.3359469812773753 NaN -0.9806633820916435 -0.42394067701883215 0.8109631867280968 NaN 0.10942852190107784 1.9159158213587495
Sleep_apnea -0.30206924318697215 -1.1925205071215925 -0.45866212499641357 -0.33543628497699784 -0.24216364039427352 NaN 0.6087478493243756 -0.10492671060118658 0.44807040710167373 -0.9534710913538825 -0.22149088695509656 0.5494229526052482 NaN 0.6754195488855113 0.8670972628844803 1.166100856671084 -0.5745710287902691 -0.10292438349222874 -0.14624401460660796 8.531930425597857 -1.3945021332024048 NaN 25.226248599171534 -0.2093182686822524 -0.15635947457911364 NaN 0.7382139927349868 NaN
Cigarrete_day -0.36970837131519274 0.3994902777777778 -0.519787673611111 -0.060185777777777755 -0.1921361014660494 0.41468411111111114 NaN 0.7773609403696051 0.3849994930555556 -0.7771374999999999 -0.4540306111111111 0.42638619791666665 NaN 0.6924784722222224 -0.19217987499999997 0.7480472222222222 0.004515289256198596 1.5000583402777778 0.39397222222222233 6.238338888888888 -0.24350416666666655 NaN 9.61798125 -0.46343512500000006 0.21624199999999993 NaN -0.2332896251594388 -0.5952485260770976
Drink_Weekly 0.7097808801775147 -0.006285750000000034 0.47315925000000003 -0.17321799999999993 -0.28786112500000005 -1.7377805555555552 0.6826805 NaN -0.1236330000000001 0.4184863750000002 0.26212050000000003 -0.3362257499999999 NaN -0.07535624999999996 0.3562888888888889 0.06038481250000005 -0.15811348611111112 -0.9815713125 0.08700138888888889 -5.126785586734694 0.5812064948979591 NaN -7.026024999999999 0.29016481250000004 -1.1194069374999998 NaN 0.47466225 2.349183673469388
Coronary_artery_disease -1.1884754068419918 0.32179553032267333 -1.7390952802137694 0.023448876212342373 0.6061383944015466 1.9467563374928458 1.316424966548419 0.20723430177481006 NaN -1.8964665173799822 0.10828475102283713 18.187878883700428 NaN 3.5277629055998765 -1.1503452441489743 0.9173054780818402 2.6398311783396364 -0.41193194459745863 0.11808590650046016 4.083969882684642 -0.6201667332161369 NaN 5.118692094265148 -0.21321455901254957 109.1324989913438 NaN -0.08794705332335037 -0.2861528378830285
Depressive_disorder 0.4394105335776016 2.3995110557298753 0.472899905804171 -0.13980258054764816 -0.3107812812386965 -1.3520035835875401 -0.9703480204528304 0.39617951356132214 -0.20035487189049975 NaN -0.8558202214973641 -0.18579031457020928 NaN -0.511724198502947 1.2853350778281385 -3.363165438440455 0.07460437070287293 -13.606626058707272 0.05537473603811774 -1.5755441115568851 1.5966578325976997 NaN -4.185280780700929 -0.04875470392378299 0.9452322727090623 NaN -0.10484423372914793 3.1396198948320095
Diet 0.3736259063728643 -0.4971092622033454 0.0938464930949689 -0.0019543126608648764 0.049746257682030615 -0.41521914863375675 1.089717325688047 -0.17488355777027348 -0.37617910388506515 -1.7391675987420112 NaN -0.7376417104494148 NaN -0.6568269022791603 0.4862661130370711 -0.03888508674817431 0.05972634329293855 0.446514341751621 -0.2955768576828895 -14.903999223151848 -0.1633160907431801 NaN -2.887139740331753 0.6698294738317814 1.8658064074584564 NaN 0.4561352880656361 1.550339546130218
Heart_failure -0.7280485392865533 0.5170462299666331 -0.6524469148426124 -0.27201104978001694 -0.03723726423287098 1.6015881821170284 1.4495281779541431 0.050218430827628724 3.4774083417415076 -0.7143393945258946 -0.16541270640527864 NaN NaN 1.8131882081978419 -0.22902456390174436 1.3150219626896642 3.030553159838271 0.2969029654528743 0.07016377639265067 11.33136592729084 -0.5522405876951331 NaN 14.131828465764409 -0.4842512149199924 11.368171909259573 NaN 0.1085186353174491 0.4746384505935568
HIV_infection -0.020562782926691933 -0.5072163383000926 0.009143972405356152 0.245567532033175 0.07650374721856712 -0.004586241702148691 0.11812861361877161 -0.11102256952000936 -0.03673511138646894 -0.28954593304127885 0.116535519463944 0.045034183690764534 NaN 0.030850771629392426 1.0006083798190222 -0.18945338098409142 0.14741895945143296 0.7420251166069827 -0.08811467408471647 1.1624563911099446 0.038212539968613624 NaN 0.4890937560519973 -0.0028515604644551718 -0.13068631304608602 NaN -0.1670078511500959 0.9954445291977668
Hypertension -0.41269014407622473 -1.049936530630581 -2.3144930662145202 0.4773430766574009 0.2389325040131762 0.9903086504988592 1.2893661657362019 0.6272604341720718 5.018233258290321 -0.779253513322783 -1.257293022710672 12.446952100517816 NaN NaN 0.41340903923392475 2.064656031526152 1.4354276304277889 -1.8180912207696336 -0.3852140236159479 19.282959652560038 1.5606847255644607 NaN 4.691085647655584 0.0916829689494817 12.639200192046774 NaN 0.27078069719102743 1.2129558634804205
Influenza_infection -0.48224822258144706 -0.19672679416184521 -0.30240650208813763 0.48701801637109166 0.36892419386162967 0.5974404395815751 0.19128180567260214 -0.09910506722969724 0.12502356497378697 -0.529194222238761 0.0014781138792159254 0.17514663104899586 NaN 0.3729160758374849 NaN 0.43597591138379843 0.06789714204709804 0.14588020708419833 0.05855440206052359 0.28301476419288263 -0.6179217073440527 NaN 4.568159688628451 -0.290425771598792 0.29037206681162325 NaN 0.2619980188890183 0.8186513928320102
Chronic_insomnia 0.07511182274313774 -0.07766709110628363 -0.23233382054536014 0.05273925811545707 -0.20044578205755992 -0.3749026492100115 0.9495547840991494 0.4511104146175582 0.15681691195876318 -2.0925155964602737 0.07905309308259517 0.0688895776643948 NaN -0.03242578574500307 1.1500260275964331 NaN 0.823516026280042 2.158266569310275 0.26849162065309295 -2.401636162211559 0.37323080240304807 NaN 0.4251296069008835 -0.27782097824087054 0.1087930755265456 NaN -0.7344197810222648 NaN
Lewy_body_dementia 1.5386213480349313 0.08010472123914023 0.03998560941543296 -0.05457516580875421 0.3277327068460236 -0.6034188653254933 0.11438606052402683 -0.03231682221998758 0.1327663618856714 -0.09941078370626441 -0.03404752754517547 0.0481924378848016 NaN -0.0522808898803941 -0.387870678945485 0.06779867860061836 NaN -0.4183328129866562 0.05806518974594685 -0.35088626972857123 1.6720682704008543 NaN 0.2832637342882708 0.37054278931611934 0.06743340619882165 NaN 0.18790694890011636 NaN
Loneliness 0.08074905340942554 -0.796806459748368 -0.142683717850717 0.11250994807402398 0.13574652720507624 0.4561578823319624 0.39979142800212825 -0.07775632821454559 0.12552684796763408 -9.755340213190117 0.09264503722946285 -0.178936299298314 NaN 0.01682203939003729 -0.6556492917861979 0.8372020387781851 2.0628550451739778 NaN 0.11106996663720353 2.046234758591032 -0.6736963929959036 NaN 2.420946008486782 -0.38399366782513766 -1.0159410293132005 NaN 0.05093518066315908 NaN
Age_at_which_the_menopause_started -0.15419026193661572 1.4368601768330478 0.6995084709222308 0.4528029727701768 0.45213588613377353 -0.7888863480433049 1.4914941652605378 0.3111342650607406 0.05692640978772623 -1.2377043198775697 -0.18229395200492704 0.19510408421927466 NaN 0.7130423502287397 0.2692552267465378 1.8263891727704002 -0.10187649982363142 -0.24789355096692445 NaN 2.2087451788408643 -1.8713033943852964 NaN -20.809078807275114 1.640166120924121 -1.5281942550141066 NaN 2.8908968911836173 -0.1601761603881348
Obesity -0.27509786059642727 -0.18641989959092486 -0.41557734474886593 -0.11333039348039248 0.43984441414738307 2.61395533890635 0.8357622540345057 0.021658567290446795 0.5141286932945128 -1.4276903816478532 -0.8677879544892374 1.7943479260667639 0.2405308405608495 0.935673053592607 0.5457322317790856 0.2732900023793065 -1.1360315300040609 0.5891735738061801 0.11196373256733946 NaN -0.8537670964808877 NaN 10.3278819253573 -0.00563369553926002 -0.13473404764922509 NaN -0.08759584675418113 -0.39985375318738575
Parkinson_disease 0.3087793602045773 0.03490192936078303 0.0140306493836726 0.2143684878700221 -0.1452923512879877 -0.5478062181467481 -0.2196461318703364 0.18299208904635036 -0.09072676031373367 0.13036429476205508 0.03771630103183199 -0.1673130589233395 NaN -0.08892031037332258 0.8612451658848949 0.10981641141009084 37.68891290999757 -0.6792435949245574 0.04204382813853544 -0.21553523801100344 NaN NaN -0.39230277401193425 0.10483411124525685 0.1460960637366813 NaN -0.04149394298385606 0.4999628533227483
Pineapple_intake 0.2591716346037269 0.05062691625836585 0.05555863158260296 0.2776814243109069 0.26408543793183514 0.0956203846387208 0.3986667053370012 -0.024084630867752116 0.06505684332829631 -0.03108769924840637 -0.010662494932830294 -0.20723812727677565 NaN 0.047683813382310564 0.26304536594985145 -0.18676712365285675 -1.1852061435894334 0.16118242625696724 0.023332963850832278 0.19628373850200453 0.066802353426674 NaN NaN 0.1253302315598091 -0.16713810632170473 0.094990948328316 1.2006917029456614 NaN
Psychosocial_stress_measurement 0.2273427807265014 -0.10656109481778564 -0.12684928328646838 0.16838350509084024 0.5877980943913609 1.0547264038773394 0.20608677869116432 0.2871730416712518 0.283916382444594 -2.3073203185425557 0.4661454151576398 0.08839490898763916 NaN 0.20525664830016224 -0.6926764945220547 0.4139763682722343 -0.4879944516779799 2.2579465800178067 -0.05914882178944511 0.3724671191825365 -0.17911278485065396 NaN NaN -0.5556073706172187 0.46140067061906304 NaN 0.3604360653900538 0.06028263466314407
Skin_color -0.10716528880943366 -0.017624201152774938 -0.10663252912340843 0.13882465300838293 -0.06279251581030718 -0.03839527705792661 0.10543639913000086 0.014323376047108816 0.034413347687380635 -0.14368885067150236 0.1966675982967307 0.09962433274421244 NaN 0.030460930702883318 5.4836071830970425 0.5474193739711315 -1.073295061270398 0.13634950588236533 0.015111289457522672 -0.08352757892751092 -0.3133782570593868 NaN -2.2266244915201896 NaN 0.756265813919627 NaN 0.14303636878624115 NaN
Stroke -0.6957831915746581 1.0269274459288558 -4.437592119318345 -0.05073386158820928 0.36127496904824646 1.9782418859324582 1.0405753756537677 0.10948987525804416 3.9238568174915525 -0.6315754129994501 -0.028786784453065345 5.4295073338922215 NaN 1.4435026262247863 0.9714612030549237 0.2095307487623737 0.6309515820942355 0.8104309875529885 0.23846809172265765 3.1011232826891066 -0.9367920074188425 NaN 2.7012681686142255 -0.27730927310768205 NaN NaN -0.3053358738995332 0.4122523269692788
Vascular_dementia 0.051124253746248266 -0.18849895413916012 -0.04787718231852374 0.14031739548793992 -0.004605281142301902 -0.05214878409076505 -0.11272954830485611 0.02218878690149929 0.013666958112870622 -0.07330229536173691 0.028282526259056813 -0.0816850262181647 NaN 0.029877744466179485 2.3871068429616695 0.6501658270586905 0.9607381500689992 0.2644668234283301 0.017525957858561154 0.19558567976956787 0.016970389455157824 -0.00321423892535959 NaN 0.23281957191026995 -0.5383709702950953 NaN -1.0257484407595499 NaN
Female_Infertility 0.14335492220469667 0.12112381182206436 -0.12580771438229146 0.545565855109892 0.18961329795276655 0.14958835514233235 0.0782986087266111 -0.003903608696522981 0.17118443019475085 -0.2526059189509416 0.01554940592019416 -0.027868185142117502 0.4081708170907722 0.04129151566702008 0.4583571738644706 0.4545347001261753 0.6971508554097137 -0.3937717368389359 -0.2776313171862396 0.44824209294320183 0.122176637006914 NaN -1.343215513152233 -0.14202620580185424 -0.26528635731151967 NaN NaN 0.1297237471708452
Male_Infertility -0.4483729970384694 0.07035514395136762 0.001330289233659479 0.030230501409988397 0.08182006675720574 0.22450868066776103 0.13361738516758498 -0.09818871221250344 -0.013702354158072305 -0.24584103369657087 -0.20507475297991754 -0.33836151731560543 -0.24348079638276776 0.01816690350359297 0.031683043587805465 0.37346881426559386 0.06621012176862506 -0.03330331942747253 0.10000910606193325 -0.3836609306705073 -0.3562371110455059 NaN 0.26255899948507894 -0.23189680414248376 -1.0289147959183673 NaN 0.0325644535047834 NaN
"

# Step 1: Split into lines
lines <- strsplit(zscore, "\n")[[1]]
# Remove empty lines
lines <- lines[lines != ""]

# Step 2: Split each line into fields (by space(s))
# Use strsplit with "\\s+" (one or more whitespace)
split_lines <- strsplit(lines, "\\s+")

# Step 3: Extract rownames and numeric matrix
rownames <- sapply(split_lines, `[`, 1)        # first element of each line
mat_data <- lapply(split_lines, function(x) x[-1])  # rest elements per line

# Step 4: Convert to numeric matrix, replacing "NaN" with NA
mat_zscore <- do.call(rbind, lapply(mat_data, function(x) {
  as.numeric(ifelse(x == "NaN", NA, x))
}))

# Assign dimnames
dimnames(mat_zscore) <- list(rownames, rownames)

# Now mat_numeric is a numeric matrix with row and col names

# Optional: Check structure
str(mat_zscore)


##pval
pval <- "
Alzheimer's_Disease NaN 1.0 0.048 0.021 0.966 0.624 1.0 1.0 1.0 0.949 0.0 1.0 NaN 1.0 0.867 0.014 0.0 0.703 0.984 1.0 0.0 NaN 0.573 0.523 1.0 NaN 0.927 0.966
Diabetes_mellitus_type_1  0.001 NaN 1.0 0.218 1.0 0.998 0.0 0.16 0.0 0.023 0.0 0.0 NaN 0.0 0.333 0.011 0.507 0.318 0.0 1.0 0.0 NaN 0.134 0.658 0.0 NaN 0.915 NaN
Diabetes_mellitus_type_2 0.0 1.0 NaN 0.04 0.995 1.0 1.0 0.228 1.0 0.0 0.0 1.0 NaN 1.0 0.992 0.999 0.999 0.959 1.0 1.0 0.001 NaN 1.0 0.782 1.0 NaN 0.003 0.623
Covid-19_infection 0.874 0.0 0.022 NaN 0.0 0.921 0.998 1.0 0.998 0.202 0.0 1.0 NaN 1.0 0.047 0.992 0.397 0.03 1.0 1.0 1.0 NaN 0.973 0.292 0.0 NaN 0.387 0.54
Covid-19_Very_severe_respiratory_confirmed_covid_vs._population 0.835 0.077 0.0 0.0 NaN 0.989 0.999 0.898 0.463 0.947 0.0 0.987 NaN 0.072 0.515 0.935 0.587 0.515 1.0 0.999 0.989 NaN 0.923 0.839 0.001 NaN 0.31 0.124
Sleep_apnea 0.997 1.0 1.0 0.972 0.975 NaN 0.0 0.948 0.0 1.0 1.0 0.002 NaN 0.0 0.282 0.0 0.957 0.66 1.0 0.0 1.0 NaN 0.001 0.852 0.861 NaN 0.071 NaN
Cigarrete_day 1.0 0.0 1.0 0.644 0.955 0.001 NaN 0.0 0.0 1.0 1.0 0.004 NaN 0.0 0.696 0.0 0.702 0.0 0.0 0.0 0.942 NaN 0.002 0.937 0.244 NaN 0.881 0.833
Drink_Weekly 0.0 0.584 0.0 0.869 0.988 1.0 0.0 NaN 0.994 0.0 0.0 0.983 NaN 0.979 0.409 0.359 0.835 0.998 0.021 1.0 0.001 NaN 1.0 0.248 1.0 NaN 0.158 0.132
Coronary_artery_disease 1.0 0.0 1.0 0.441 0.0 0.0 0.0 0.001 NaN 1.0 0.02 0.0 NaN 0.0 0.929 0.0 0.003 0.952 0.0 0.0 1.0 NaN 0.006 0.774 0.0 NaN 0.752 0.902
Depressive_disorder 0.0 0.0 0.0 0.799 0.987 1.0 1.0 0.0 1.0 NaN 1.0 0.9 NaN 1.0 0.218 1.0 0.609 1.0 0.091 0.998 0.0 NaN 0.989 0.591 0.004 NaN 0.654 0.065
Diet 0.0 1.0 0.03 0.493 0.351 0.998 0.0 0.997 1.0 1.0 NaN 1.0 NaN 1.0 0.398 0.564 0.629 0.039 1.0 1.0 0.876 NaN 0.977 0.148 0.0 NaN 0.206 0.199
Heart_failure 1.0 0.0 1.0 0.954 0.67 0.0 0.0 0.168 0.0 1.0 0.997 NaN NaN 0.0 0.718 0.0 0.001 0.101 0.038 0.0 1.0 NaN 0.0 0.988 0.0 NaN 0.373 0.236
HIV_infection 0.868 1.0 0.243 0.0 0.01 0.557 0.001 1.0 0.999 1.0 0.0 0.088 NaN 0.0 0.113 0.997 0.239 0.0 1.0 0.0 0.101 NaN 0.151 0.646 0.984 NaN 0.93 0.097
Hypertension 1.0 1.0 1.0 0.011 0.037 0.0 0.0 0.0 0.0 1.0 1.0 0.0 NaN NaN 0.392 0.0 0.055 1.0 1.0 0.0 0.0 NaN 0.009 0.462 0.0 NaN 0.383 0.246
Influenza_infection 1.0 0.993 1.0 0.001 0.001 0.0 0.014 0.971 0.006 1.0 0.499 0.097 NaN 0.0 NaN 0.005 0.587 0.225 0.055 0.134 1.0 NaN 0.017 0.805 0.127 NaN 0.28 0.278
Chronic_insomnia 0.212 0.866 1.0 0.455 0.946 0.997 0.0 0.0 0.001 1.0 0.095 0.365 NaN 0.814 0.25 NaN 0.127 0.0 0.0 0.999 0.017 NaN 0.375 0.759 0.303 NaN 0.992 NaN
Lewy_body_dementia 0.0 0.126 0.169 0.69 0.002 1.0 0.073 0.764 0.002 0.925 0.765 0.361 NaN 0.946 0.816 0.307 NaN 0.955 0.056 0.883 0.0 NaN 0.406 0.443 0.472 NaN 0.304 NaN
Loneliness 0.24 1.0 0.997 0.307 0.118 0.002 0.001 0.907 0.003 1.0 0.054 0.888 NaN 0.328 0.847 0.0 0.008 NaN 0.01 0.001 1.0 NaN 0.103 0.824 1.0 NaN 0.572 NaN
Age_at_which_the_menopause_started 0.756 0.0 0.0 0.14 0.08 0.993 0.0 0.038 0.347 1.0 0.894 0.327 NaN 0.0 0.563 0.0 0.727 0.684 NaN 0.014 1.0 NaN 1.0 0.331 0.997 NaN 0.003 0.664
Obesity 0.999 0.996 1.0 0.835 0.0 0.0 0.0 0.308 0.0 1.0 1.0 0.0 0.427 0.0 0.333 0.042 0.997 0.011 0.002 NaN 1.0 NaN 0.0 0.624 0.841 NaN 0.646 0.945
Parkinson_disease 0.0 0.257 0.355 0.045 0.951 1.0 0.998 0.0 0.992 0.019 0.207 0.954 NaN 1.0 0.252 0.203 0.0 0.999 0.083 0.857 NaN NaN 0.751 0.454 0.262 NaN 0.58 0.33
Pineapple_intake 0.034 0.264 0.249 0.426 0.07 0.341 0.051 0.636 0.227 0.726 0.634 0.813 NaN 0.149 0.281 0.681 0.933 0.334 0.344 0.431 0.37 NaN NaN 0.32 0.689 0.36 0.084 NaN
Psychosocial_stress_measurement 0.01 0.949 0.999 0.124 0.0 0.0 0.011 0.0 0.0 1.0 0.0 0.258 NaN 0.0 0.878 0.007 0.943 0.0 0.937 0.081 0.908 NaN NaN 0.909 0.037 NaN 0.184 0.548
Skin_color 0.821 0.575 0.968 0.294 0.695 0.625 0.161 0.419 0.259 0.933 0.002 0.292 NaN 0.206 0.028 0.026 0.971 0.312 0.386 0.639 0.958 NaN 0.971 NaN 0.024 NaN 0.389 NaN
Stroke 1.0 0.0 1.0 0.657 0.003 0.0 0.0 0.028 0.0 1.0 0.721 0.0 NaN 0.0 0.245 0.102 0.173 0.003 0.0 0.0 1.0 NaN 0.007 0.791 NaN NaN 0.931 0.419
Vascular_dementia 0.275 0.998 0.82 0.492 0.531 0.695 0.789 0.436 0.404 0.783 0.294 0.704 NaN 0.194 0.008 0.044 0.082 0.315 0.344 0.353 0.465 0.527 NaN 0.228 0.965 NaN 0.911 NaN
Female_Infertility 0.024 0.034 0.998 0.0 0.038 0.086 0.176 0.56 0.0 1.0 0.36 0.609 0.238 0.099 0.361 0.005 0.108 0.968 1.0 0.061 0.144 NaN 0.93 0.781 0.956 NaN NaN 0.644
Male_Infertility 1.0 0.118 0.479 0.43 0.188 0.018 0.036 0.984 0.679 1.0 1.0 0.999 0.674 0.274 0.521 0.015 0.594 0.585 0.001 0.955 0.998 NaN 0.344 0.895 1.0 NaN 0.554 NaN
"

# Step 1: Split into lines
lines <- strsplit(pval, "\n")[[1]]
# Remove empty lines
lines <- lines[lines != ""]

# Step 2: Split each line into fields (by space(s))
# Use strsplit with "\\s+" (one or more whitespace)
split_lines <- strsplit(lines, "\\s+")

# Step 3: Extract rownames and numeric matrix
rownames <- sapply(split_lines, `[`, 1)        # first element of each line
mat_data <- lapply(split_lines, function(x) x[-1])  # rest elements per line

# Step 4: Convert to numeric matrix, replacing "NaN" with NA
mat_pval <- do.call(rbind, lapply(mat_data, function(x) {
  as.numeric(ifelse(x == "NaN", NA, x))
}))

# Assign dimnames
dimnames(mat_pval) <- list(rownames, rownames)

# Now mat_numeric is a numeric matrix with row and col names

# Optional: Check structure
str(mat_pval)


### NMDS projection
library(smacof)
library(ggplot2)
library(ggrepel)

#for pval
# Ensure the matrix is symmetric and no missing values
dist_pval <- as.matrix(mat_pval)
dist_pval[is.na(dist_pval)] <- max(dist_pval, na.rm = TRUE)  # Replace NA with max dissimilarity

# Run NMDS using smacof
nmds_pval  <- smacofSym(dist_pval, ndim = 2, type = "ordinal", ties = "tertiary")

message("NMDS stress: ", nmds_pval$stress)

#coordinate
pval_coords <- as.data.frame(nmds_pval$conf)
colnames(pval_coords) <- c("Dim1", "Dim2")
pval_coords$Trait <- rownames(pval_coords)

pval_coords$IsAD <- pval_coords$Trait == "Alzheimer's_Disease"

# Plot
p <- ggplot(pval_coords, aes(x = Dim1, y = Dim2)) +
  #all points, gray; AD in red
  geom_point(aes(color = IsAD), size = 3, alpha = 0.8) +
  scale_color_manual(values = c("FALSE" = "grey50", "TRUE" = "firebrick"),
                     guide = FALSE) +
  # Only label non-AD traits here
  geom_text_repel(
    data = subset(pval_coords, !IsAD),
    aes(label = Trait),
    size = 3,
    max.overlaps = 30,
    segment.size = 0.2
  ) +
  # Label AD separately and in red/bold
  geom_text_repel(
    data = subset(pval_coords, IsAD),
    aes(label = Trait),
    size = 4,
    fontface = "bold",
    color = "firebrick",
    nudge_y = 0.1,
    segment.color = "firebrick"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "grey90"),
    panel.grid.minor = element_blank(),
    axis.title     = element_text(face = "bold"),
    plot.subtitle  = element_text(face = "italic")
  ) +
  labs(
    title    = "Non metric MDS of Trait Similarities for p < 1e-7 (P-value based)",
    x        = "MDS Dimension 1",
    y        = "MDS Dimension 2"
  )

p

#for zscore
# Replace NA with 0 or a safe default
mat_zscore[is.na(mat_zscore)] <- 0

# Convert similarity → dissimilarity (subtract from max)
diss_zscore <- max(mat_zscore) - mat_zscore

# Run NMDS using smacof
nmds_zscore  <- smacofSym(diss_zscore, ndim = 2, type = "ordinal", ties = "tertiary")

message("NMDS stress: ", nmds_zscore$stress)

#coordinate
zscore_coords <- as.data.frame(nmds_zscore$conf)
colnames(zscore_coords) <- c("Dim1", "Dim2")
zscore_coords$Trait <- rownames(zscore_coords)

zscore_coords$IsAD <- zscore_coords$Trait == "Alzheimer's_Disease"

# Plot
q <- ggplot(zscore_coords, aes(x = Dim1, y = Dim2)) +
  #all points, gray; AD in red
  geom_point(aes(color = IsAD), size = 3, alpha = 0.8) +
  scale_color_manual(values = c("FALSE" = "grey50", "TRUE" = "firebrick"),
                     guide = FALSE) +
  # Only label non-AD traits here
  geom_text_repel(
    data = subset(zscore_coords, !IsAD),
    aes(label = Trait),
    size = 3,
    max.overlaps = 30,
    segment.size = 0.2
  ) +
  # Label AD separately and in red/bold
  geom_text_repel(
    data = subset(zscore_coords, IsAD),
    aes(label = Trait),
    size = 4,
    fontface = "bold",
    color = "firebrick",
    nudge_y = 0.1,
    segment.color = "firebrick"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "grey90"),
    panel.grid.minor = element_blank(),
    axis.title     = element_text(face = "bold"),
    plot.subtitle  = element_text(face = "italic")
  ) +
  labs(
    title    = "Non metric MDS of Trait Similarities for p < 1e-7 (Z-score based)",
    x        = "MDS Dimension 1",
    y        = "MDS Dimension 2"
  )

q

##clustering
library(mclust)
library(dbscan)
library(RColorBrewer)

coords <- pval_coords[, c("Dim1", "Dim2")]
rownames(coords) <- pval_coords$Trait

#mclust
set.seed(42) 
mclust_res <- Mclust(coords)
pval_coords$MclustCluster <- factor(mclust_res$classification)

#dbscan
kNNdistplot(coords, k = 4)
db_res <- dbscan(coords, eps = 0.55, minPts = 4)
pval_coords$DBSCANcluster <- factor(db_res$cluster)

# Create label column
pval_coords$Label <- pval_coords$Trait

# Identify AD index
ad_idx <- which(pval_coords$IsAD)

# --- PLOT MCLUST ---
ggplot(pval_coords, aes(x = Dim1, y = Dim2, color = MclustCluster)) +
  scale_color_brewer(palette = "Set2", na.value = "grey50", name = "Cluster", drop = TRUE, na.translate = FALSE) +
  geom_point(size = 4) +
  # AD outline
  geom_point(data = pval_coords[ad_idx, ], aes(x = Dim1, y = Dim2),
             color = "darkblue", size = 8, shape = 1, stroke = 1.5, inherit.aes = FALSE, show.legend = FALSE) +
  # other labels
  geom_text(data = pval_coords[-ad_idx, ], aes(label = Label),
            size = 3, hjust = 0.5, vjust = -0.7, show.legend = FALSE) +
  # AD label
  geom_text(data = pval_coords[ad_idx, ], aes(label = Label),
            size = 5, fontface = "bold", hjust = 0.5, vjust = -0.7,
            colour = "darkblue", show.legend = FALSE) +
  labs(title = "MCLUST Clustering on NMDS Projection (p-value Matrix) for p < 1e-7") +
  theme_bw() +
  theme(legend.position = "right")

# --- PLOT DBSCAN ---
ggplot(pval_coords, aes(x = Dim1, y = Dim2, color = DBSCANcluster)) +
  scale_color_brewer(palette = "Set2", na.value = "grey50", name = "Cluster", drop = TRUE, na.translate = FALSE) +
  geom_point(size = 4) +
  geom_point(data = pval_coords[ad_idx, ], aes(x = Dim1, y = Dim2),
             color = "darkblue", size = 8, shape = 1, stroke = 1.5, inherit.aes = FALSE, show.legend = FALSE) +
  geom_text(data = pval_coords[-ad_idx, ], aes(label = Label),
            size = 3, hjust = 0.5, vjust = -0.7, show.legend = FALSE) +
  geom_text(data = pval_coords[ad_idx, ], aes(label = Label),
            size = 5, fontface = "bold", hjust = 0.5, vjust = -0.7,
            colour = "darkblue", show.legend = FALSE) + 
  labs(title = "DBSCAN Clustering on NMDS Projection (p-value Matrix) for p < 1e-7") +
  theme_bw() +
  theme(legend.position = "right")



